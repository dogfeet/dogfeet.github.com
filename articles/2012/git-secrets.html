<!DOCTYPE html>
<html lang="en">
<head>

  <meta charset="utf=8"></meta>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"></meta>
  <meta name="viewport" content="width=device-width, initial-scale=1"></meta>

  <title>#dogfeet - Git: git secrets</title>
  <meta name="description"
    content="이글은 @holman님이 싱가폴에서 열린 RedDotRubyConf에서 발표한 Git and GitHub Secrets에 설명을 달았다. 내용이 길어서 둘로 나눴는데 이 글은 Git Secetets부분을 정리한 글이다. GitHub Secrets은 다른 글에 정리한다."></meta>
  <meta name="keywords"
    content="Git,holman,Zach Holman,RedDotRubyConf"></meta>
  <meta name="author" content="Changwoo Park"></meta>

  <link rel="shortcut icon" href="images/favicon.ico"></link>
  <link rel="apple-touch-icon" href="images/apple-touch-icon.png"></link>
  <link rel="apple-touch-icon" sizes="72x72"
    href=" ='images/apple-touch-icon-72x72.png"></link>
  <link rel="apple-touch-icon" sizes="114x114"
    href="images/apple-touch-icon-114x114.png"></link>
  <link rel="alternate" type="application/atom+xml"
    title="Git: git secrets &raquo; Feed"
    href="http://feeds.feedburner.com/github/dogfeet"></link>

  <link rel="stylesheet"
    href="/bower_components/bootstrap/dist/css/bootstrap.min.css"
    media="screen, projection"></link>
  <link rel="stylesheet"
    href="/styles/style.css" media="screen, projection"></link>

</head>
<body>
  <nav class="navbar navbar-default navbar-static-top">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">dogfeet</a>
      </div>
      <div id="navbar" class="navbar-collapse collapse">
        <ul class="nav navbar-nav">
          <li><a href="/site/archive.html">Archive</a></li>
          <li><a href="/site/tagmap.html">Tagmap</a></li>
        </ul>
        <form id="search-form" class="navbar-form navbar-right" action="http://google.com/search" method="get">
          <input type="hidden" name="q" value="site:dogfeet.github.io"></input>
          <input class="form-control" type="text" name="q" results="0" placeholder="Search..."></input>
        </form>
      </div><!--/.nav-collapse -->
    </div>
  </nav>
  <div class="container">
    <div>
      <link rel="stylesheet" scoped
  href="/styles/github.css"
  media="screen, projection"></link>
<link rel="stylesheet" scoped
  href="/styles/markdown.css"
  media="screen, projection"></link>

<section class="content">
  <article id="post" class="row post " typeof="sioc:post" about="articles/2012/git-secrets.html" lang="ko-kr">
    <div class="col-sm-2 small-font">
      <br /><br />
      <p property="dc:created">2012 Dec 19</p>
      <p class="small-font top-line"> - by<br /><a href="https://twitter.com/pismute/">Changwoo Park</a></p>
      <div id="social-buttons" class="top-line">
        <ul class="unstyled">
          <li><a class="twitter-share-button" href="https://twitter.com/share"
            data-url="http://dogfeet.github.io/articles/2012/git-secrets.html" data-via="Changwoo Park"
            data-count="horizontal" data-lang="en">Tweet</a></li>
          <li><div class="g-plusone" data-size="medium" data-href="http://dogfeet.github.io/articles/2012/git-secrets.html"></div></li>
          <li><div class="fb-like"
            data-href="http://dogfeet.github.io/articles/2012/git-secrets.html" data-send="false"
            data-layout="button_count" data-show-faces="false"></div></li>
        </ul>
      </div>

      <p class="small-font top-line"><a href="/site/tagmap.html#git" class="tag">Git</a> <a href="/site/tagmap.html#holman" class="tag">holman</a> <a href="/site/tagmap.html#zach holman" class="tag">Zach Holman</a> <a href="/site/tagmap.html#reddotrubyconf" class="tag">RedDotRubyConf</a></p>
    </div>

    <div class="col-sm-10">

      <div property="sioc:content"><h1 id="git-git-secrets">Git: git secrets</h1>
<p>이글은 @holman님이 싱가폴에서 열린 <a href="http://reddotrubyconf.com/">RedDotRubyConf</a>에서 발표한 <a href="http://zachholman.com/talk/git-github-secrets">Git and GitHub Secrets</a>에 설명을 달았다. 내용이 길어서 둘로 나눴는데 이 글은 <code>Git Secetets</code>부분을 정리한 글이다. <a href="/articles/2012/git-github-secrets.html">GitHub Secrets</a>은 다른 글에 정리한다.</p>
<p>Git은 명령과 옵션이 굉장히 많은데, 그 중에서 @holman님이 추천하는 쓸만한 것이라고 생각하면 되겠다.</p>
<p><img src="/articles/2012/git-secrets/holman.png" alt="holman"></p>
<h2 id="git-secret">Git secret</h2>
<h3 id="-allow-empty">—allow-empty</h3>
<p>파일없이 커밋할 수 있다:</p>
<pre><code class="lang-sh">$ git commit -m &quot;LOOK AT ME TROLOLOL&quot; --allow-empty
</code></pre>
<p><code>git log</code>를 하면 아무내용없이 그냥 커밋 개체만 달랑 생긴다.</p>
<pre><code class="lang-sh">$ git log
commit 6eb28f645174fba20d819f40da4ca822c7c67b2a
Author: Changwoo Park &lt;pismute@gmail.com&gt;
Date:   Tue Nov 12 20:32:25 2012 +0900

    LOOK AT ME TROLOLOL
</code></pre>
<p>히스토리에 뭔가 표식을 남기고 싶을 때 유용하다.</p>
<h3 id="staging-hunk">Staging Hunk</h3>
<p>파일에서 한 부분? 덩어리?를 Hunk라고 부른다. <code>git add -p</code> 명령으로 파일을 통째로 Staging Area에 넣는게 아니라 일정 부분만(hunk만) 골라서 넣는다.</p>
<p>자세한 설명은 @semtlnori님의 <a href="http://npcode.com/blog/archives/449">깔끔하게 커밋하기</a>를 보자.</p>
<h3 id="git-show-query">git show :/query</h3>
<p>특정 질의가 들어간 커밋 중에서 가장 최근 커밋 하나를 찾아 준다. 로그를 분석할때 매우 유용하다. 커밋 메시지, 파일 이름, 파일 내용에서 찾는다.</p>
<p><code>git log</code> 명령에도 있어서 <code>git log :/query</code>라고 실행해도 된다. <code>:/query</code> 만족하는 커밋을 골라서 보여준다.</p>
<h3 id="go-back">go back</h3>
<p><code>cd -</code>라고 실행하면 이전 디렉토리로 되돌아 간다. <code>cd</code>명령 처럼 <code>git checkout -</code>라고 하면 이전 브랜치를 checkout한다.</p>
<h3 id="merged-branch">merged branch</h3>
<p>브랜치나 커밋이 다른 브랜치에 Merge됐는지 확인하는 명령들.</p>
<ul>
<li><code>git branch --merged</code> : 이미 다른 브랜치에 머지된 것만 보여준다.</li>
<li><code>git branch --no-merged</code> : 아직 다른 브랜치에 머지되지 않는 것만 보여준다.</li>
<li><code>git branch --contains 838ad46</code> : 특정 커밋이 포함된 브랜치만 보여준다.</li>
</ul>
<h3 id="content-copy">Content Copy</h3>
<p>브랜치를 변경하지 않고도 다른 브랜치에 들어 있는 파일을 복사해 올 수 있다:</p>
<pre><code class="lang-sh">$ git checkout BRANCH -- path/to/file.rb
</code></pre>
<p><code>path/to/file.rb</code>에 파일이 복사된다.</p>
<p>Reset과 Checkout은 비슷해보여서 구분하기 쉽지 않다. Checkout은 데이터베이스에서 뭔가를 꺼낼때 사용하는 명령이다. 옵션도 스냅샷과 파일이름 등 그와 관련된 옵션으로 구성돼있다. 반대로 Reset은 워킹 디렉토리, Staging Area, 브랜치 등을 스냅샷으로 Reset하는 명령이다.</p>
<p>이렇게 구분하면 쉽다. 데이터베이스에서 뭔가를 꺼낼때는 Checkout을 사용하고 그외는 Reset을 사용한다.</p>
<h3 id="reachable-commits">Reachable Commits</h3>
<p>특정 브랜치에만 있는 커밋이 보고 싶을 때는 다음과 같이 한다:</p>
<p><code>git log branchA ^branchB</code></p>
<p>branchA에는 있고 branchB에는 없는 커밋을 보여준다.</p>
<h3 id="finding-lost-commits">FINDING LOST COMMITS</h3>
<p>어떤 브랜치에도 들어 있지 않은 커밋을 보여준다. git의 커밋은 개체는 실제로 전부 immutable이라서 커밋을 수정하면 새로운 커밋 개체가 등록된다. 잘 못 수정했으면 아래 명령으로 커밋을 찾아서 복구한다:</p>
<pre><code class="lang-sh">$ git fsck --lost-found
Checking object directories: 100% (256/256), done.
dangling commit 4a7f2e89a480d3af0ccfdf71f76f4149f25fb0fb
dangling commit d3ad9f17532109d12084646c306e9d7748c2f791
</code></pre>
<p>어떤 브랜치에도 속하지 않은 커밋이 두 개있다.</p>
<h2 id="diffstats">DIFFSTATS</h2>
<p>델타(diff)를 다 보여주는 게 기본인데 통계만 볼 수도 있다:</p>
<p><code>git diff HEAD^ --stat</code></p>
<p><img src="/articles/2012/git-secrets/git-diff--stat.png" alt="git-diff--stat"></p>
<h3 id="blame">BLAME</h3>
<p><code>git blame</code>은 기본적으로 어떤 라인을 누가 고쳤는지 확인하는 명령이다.</p>
<p><strong>blame이니까</strong></p>
<p><code>git blame</code>은 기본적으로 어떤 라인을 <strong>어떤 새끼</strong>가 고쳤는지 확인하는 명령이다.</p>
<h4 id="git-blame-w">git blame -w</h4>
<p>정말 내용을 수정한 <strong>새끼</strong>를 찾는다. 공백만 추가한 경우는 무시한다. <code>git diff HEAD~</code> 명령으로 공백이 어디에 추가됐는지 보자:</p>
<p><img src="/articles/2012/git-secrets/git-blame-w-diff.png" alt="git-blame-w-diff"></p>
<p>히스토리를 보면 마지막에 “BBB”가 공백을 추가했다:</p>
<p><img src="/articles/2012/git-secrets/git-blame-w-lg.png" alt="git-blame-w-lg"></p>
<p>다음은 <code>git blame -w</code>의 결과다:</p>
<p><img src="/articles/2012/git-secrets/git-blame-w.png" alt="git-blame-w"></p>
<p>단순히 공백만 추가한 “BBB”는 무시된다. <code>-w</code>을 옵션을 빼고 <code>git blame</code>만 실행하면 공백만 추가한 “BBB”도 나온다.</p>
<p><img src="/articles/2012/git-secrets/git-blame.png" alt="git-blame"></p>
<h4 id="git-blame-m">git blame -M</h4>
<p>해당 라인을 실질적으로 마지막에 수정한 사람을 보여준다. 이 옵션을 주면 같은 파일 내에서 단순히 라인을 옮긴 사람이 아니라 마지막으로 내용을 수정한 사람이 표시된다:</p>
<p>텍스트를 옮긴 후에 <code>git blame</code> 명령을 실행하면 다음과 같이 나온다:</p>
<p><img src="/articles/2012/git-secrets/git-blame-m-before.png" alt="git-blame"></p>
<p><code>-M</code> 옵션을 추가하면 단순히 옮긴 사람이 아니라 원래 그 코드를 추가한 사람을 보여준다:</p>
<p><img src="/articles/2012/git-secrets/git-blame-m.png" alt="git-blame"></p>
<p>원래 의도는 측근 <code>all.md</code> 파일에서 친구 끼리, 가족 끼리 모아서 <code>-M</code> 옵션을 설명할 계획이였다. Git이 정확히 어떤 알고리즘을 사용하는 건지 나중에 살펴봐야 겠다.</p>
<h4 id="git-blame-c">git blame -C</h4>
<p><code>-M</code>와 비슷하게 실제로 마지막에 수정한 사람을 보여준다. 한 파일 내에서의 이동만 감지하는 것이 아니라. 같은 커밋에서의 다른 파일간 이동도 감지한다.</p>
<p><code>all.md</code>라는 파일에서 친구는 <code>friends.md</code>라는 파일로 옮기고 가족은 <code>family.md</code> 파일로 옮겼다. 아래는 <code>git blame -f family.md</code>의 결과다:</p>
<p><img src="/articles/2012/git-secrets/git-blame-c-f.png" alt="git-blame"></p>
<p><code>-f</code>는 원래 파일이름을 보여주는 옵션이다. <code>git blame -fC family.md</code>의 결과는 아래와 같다:</p>
<p><img src="/articles/2012/git-secrets/git-blame-c-cf.png" alt="git-blame"></p>
<h4 id="git-blame-cc">git blame -CC</h4>
<p><code>-C</code> 처럼 다른 파일에서 옮긴 것을 감지해주는데 해당 파일을 생성한 커밋내에서도 감지한다.</p>
<h4 id="git-blame-ccc">git blame -CCC</h4>
<p>다른 파일에서 옮긴 것도 감지하는데 커밋을 가리지 않고 전체에서 찾는다.</p>
<h4 id="multi-remote-fetches">MULTI-REMOTE FETCHES</h4>
<p>원래는 하나씩 fetch해야 하지만 group을 만들어서 한번에 fetch할 수 있다.</p>
<pre><code class="lang-sh">$ git config remotes.mygroup &#39;remote1 remote2&#39;
$ git fetch mygroup
</code></pre>
<h4 id="a-better-status">A BETTER STATUS</h4>
<p>status의 결과를 더 간략하게 볼 수 있다.</p>
<p><code>git status</code>:</p>
<p><img src="/articles/2012/git-secrets/git-status.png" alt="git-status"></p>
<p><code>git status -sb</code>:</p>
<p><img src="/articles/2012/git-secrets/git-status-sb.png" alt="git-status-sb"></p>
<h4 id="word-diffing">WORD DIFFING</h4>
<p>라인 단위로 비교하는 것이 아니라 단어 단위로 비교해서 볼 수 있다.</p>
<p><code>git diff HEAD^</code>:</p>
<p><img src="/articles/2012/git-secrets/git-diff-head-1.png" alt="diff-head-1"></p>
<p><code>git diff HEAD^ --word-diff</code>:</p>
<p><img src="/articles/2012/git-secrets/git-diff-head-1--word-diff.png" alt="diff-head-1--word-diff"></p>
<h4 id="config-spelling">CONFIG: SPELLING</h4>
<p><code>git comit</code>이라고 실행하면 <code>commit</code>이라고 할려고 했냐? 라고 물어봐 주는 게 기본설정이다. 명령을 실행할 때 오타를 내면 자동으로 인식해서 실행하게 할 수 있다. 다음과 같이 설정하면 된다:</p>
<pre><code class="lang-sh">$ git config --global help.autocorrect 1
</code></pre>
<p>이 옵션이 설정되면 <code>git comit</code>이라고 실행하면 그냥 <code>git commit</code>이 실행된다:</p>
<h4 id="config-git-rerere-reuse-recorded-resolution-">CONFIG: GIT RERERE(REUSE RECORDED RESOLUTION)</h4>
<p><a href="/articles/2012/git-rerere.html">Git: rerere</a>에서 확인한다.</p>
<h4 id="config-color-">CONFIG: COLOR!</h4>
<p>다음과 같이 설정하면 결과가 칼라로 나온다.</p>
<pre><code class="lang-sh">$ git config --global color.ui 1
</code></pre>
<h4 id="alias-git-amend">ALIAS: GIT-AMEND</h4>
<p>아래와 같이 alias를 등록하면 <code>git amend</code>라고 실행해서 HEAD 커밋을 수정할 수 있다. <code>-C</code> 옵션이 있기 때문에 커밋 메시지는 수정하지 않는다. 항상 커밋 메시지를 확인하고 싶으면 <code>-C HEAD</code>를 빼면 된다.</p>
<pre><code class="lang-sh">$ git config --global alias.amend &quot;commit --amend -C HEAD&quot;
</code></pre>
<h4 id="alias-git-undo">ALIAS: GIT-UNDO</h4>
<p>가장 최근 커밋을 되돌린다. <code>--soft</code>이기 때문에 그 커밋의 개체는 Staged 상태로 남는다:</p>
<pre><code class="lang-sh">$ git config --global alias.undo &quot;reset --soft HEAD^&quot;
</code></pre>
<h4 id="alias-git-count">ALIAS: GIT-COUNT</h4>
<p>누가 얼마나 커밋했는지 보여준다:</p>
<pre><code class="lang-sh">$ git config --global alias.count &quot;shortlog -sn&quot;
</code></pre>
<p><img src="/articles/2012/git-secrets/git-shortlog-sn.png" alt="git-shortlog-sn"></p>
<h4 id="script-git-credit">SCRIPT: GIT-CREDIT</h4>
<p>가장 마지막 커밋 author 정보를 바꿀일은 종종 생긴다. 실수일 수도 있고 아닐 수도 있지만 뭐 어찌됐건 최근 커밋의 author를 마음대로 바꾸고 싶을 때가 있다. 다음과 같이 config에 등록한다:</p>
<pre><code class="lang-sh">#!/bin/sh

git commit --amend --author &quot;$1 &lt;$2&gt;&quot; -C HEAD
</code></pre>
<p><code>git credit &quot;Zach Holman&quot; zach@example.com</code>이라고 실행하면 최근 커밋의 author 정보가 변경된다.</p>
<p>@holman님은 @holman님의 <a href="https://github.com/holman/dotfiles/tree/master/bin">dotfile</a> 프로젝트에 가면 @holman님이 사용하는 <code>git-credit</code> 스크립트가 있다.</p>
<h4 id="octocat">Octocat</h4>
<p>이 슬라이드로 옥토캣은 다리가 4개고 꼬리가 1개라는 비밀을 알게 됐다. 맨날 보는 그림이지만 문어니까 그냥 다리가 8개라고 생각했었다.</p>
<p><img src="/articles/2012/git-secrets/pusheencat.png" alt="octocat"></p>
</div>
    </div>
  </article>
</section>

<div id="fb-root"></div>
<script src="//connect.facebook.net/en_US/all.js#xfbml=1"></script>
<script src="http://platform.twitter.com/widgets.js"></script>
<script src="https://apis.google.com/js/plusone.js"></script>

    </div>
    <footer class="footer"><p>Copyright &copy; 2008+ Dogfeet from coding to pixels</p></footer>
  </div>

  <script src="/bower_components/jquery/dist/jquery.js"></script>
  <script src="/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
  <script src="/scripts/script.js"></script>

  <script>
    if( 'http://dogfeet.github.io/' === 'http://' + window.location.hostname ) {
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-27493298-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    }
  </script>
</body>
</html>
