<!DOCTYPE html><html lang="en"><head><!--Meta--><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta http-equiv="content-type" content="text/html; charset=utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>#dogfeet - Git:merge</title><meta name="description" /><meta name="keywords" /><meta name="author" content="Changwoo Park" /><!--Icons--><link rel="shortcut icon" href="images/favicon.ico" /><link rel="apple-touch-icon" href="images/apple-touch-icon.png" /><link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png" /><link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png" /><link rel="alternate" type="application/atom+xml" title="개발새발 &raquo; Feed" href="http://feeds.feedburner.com/github/dogfeet" /><!--Shims: IE6-8 support of HTML5 elements--><!--[if lt IE 9]>
        <script async src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]--><!--Styles--><link rel="stylesheet" href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.0/css/bootstrap-combined.min.css" media="screen, projection" /><link rel="stylesheet" href="/css/highlight/github.css" media="screen, projection" /><link rel="stylesheet" href="/styles/style.css" media="screen, projection" /><link rel="stylesheet" href="/styles/markdown.css" media="screen, projection" /><!--Scripts--><script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js"></script><script src="http://cdnjs.cloudflare.com/ajax/libs/modernizr/2.0.6/modernizr.min.js"></script><script src="http://connect.facebook.net/en_US/all.js#xfbml=1"></script><script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.0/js/bootstrap.min.js"></script><script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-collapse.js"></script><script src="/scripts/script.js"></script></head><body><!--Topbar--><div class="navbar navbar-static-top"><div class="navbar-inner"><div class="container"><a class="btn btn-navbar pull-right" data-toggle="collapse" data-target=".nav-collapse"><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></a><a class="brand" href="/">dogfeet</a><div class="nav-collapse collapse"><ul class="nav"><li><a href="/site/tagmap.html">Tagmap</a></li><li><a href="/site/archive.html">Archive</a></li><li><a href="/site/atelier.html">Atelier</a></li><li><a href="http://feeds.feedburner.com/github/dogfeet"><img src="http://forum.tattersite.com/ko/style/Textcube/feed-icon.png" /></a></li></ul><form id="search-form" class="pull-right navbar-search" action="http://google.com/search" method="get"><input type="hidden" name="q" value="site:dogfeet.github.com" /><input type="text" name="q" results="0" placeholder="Search" search-query /></form></div></div></div></div><!--Markup--><div class="container"><div><script src="http://platform.twitter.com/widgets.js"></script><script>//facebook
(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));

//google plusone
(function() {
  var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
  po.src = 'https://apis.google.com/js/plusone.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
})();
</script><section class="content"><article id="post" class="post undefined" typeof="sioc:post" about="/articles/2011/git-merge.html" lang="ko-kr"><div class="row"><div class="span2 muted modern-font small-font"><span property="dc:created">2011 Dec 10 &raquo;</span></div><div class="span10"><h1 property="dcterms:title">Git:merge</h1></div></div><div class="row"><div class="offset2 span10 modern-font small-font muted"><span>&nbsp; by <a href="https://twitter.com/pismute/">Changwoo Park</a></span>
 | <a href="/site/tagmap.html#git" class="tag">Git</a> <a href="/site/tagmap.html#branch" class="tag">Branch</a> <a href="/site/tagmap.html#merge" class="tag">Merge</a> <a href="/site/tagmap.html#rebase" class="tag">Rebase</a> | <span><a href="/articles/2011/git-merge.html#disqus_thread" data-disqus-identifier="/articles/2011/git-merge.html"></a></span>
</div></div><div class="row"><div class="offset2 span10"><br/><style rel="stylesheet" media="screen, projection" scoped="scoped">#social-buttons {
  margin-left: 30px;
}</style><div id="social-buttons" class="pull-right"><ul class="unstyled"><li><a class="twitter-share-button" href="https://twitter.com/share" data-url="http://dogfeet.github.com/articles/2011/git-merge.html" data-via="pismute" data-count="horizontal" data-lang="en">Tweet</a></li><li><div class="g-plusone" data-size="medium" data-href="http://dogfeet.github.com/articles/2011/git-merge.html"></div></li><li><div class="fb-like" data-href="http://dogfeet.github.com/articles/2011/git-merge.html" data-send="false" data-layout="button_count" data-show-faces="false"></div></li></ul></div><div property="sioc:content"><p>커밋 히스토리는 굉장히 잘 관리해야 한다. 이 글은 merge를 잘해서 히스토리를 잘 관리하는 방법을 설명한다.</p>

<p>git의 최고의 장점은 모든 것을 나중으로 미룰 수 있다는 것이다. 이 말의 의미는 언제나 히스토리를 원하는 대로 편집할 수 있다는 것을 의미한다. 기존의 커밋 여러 개를 하나로 합치거나 커밋 하나를 여러 개로 쪼갤 수 있다. 이미 커밋된 개체에 들어 있는 committer나 author 정보를 수정할 수도 있다. 이런 git의 막강한 기능을 이용해서 모든 참여자가 쉽게 이해할 수 있고 쉽게 관리할 수 있는 히스토리를 만들어 나아가야 한다. 히스토리를 단장하는 방법도 굉장히 흥미로운 주제지만 내용이 많아서 이 글에서 다루지 않는다. 나중에 다시 다루기로 하겠다.</p>

<p>히스토리를 단장하기 위해 다음과 같은 몇 가지 사항을 꼭 기억해야 한다.</p>

<ul>
<li>Fast-forward merge와 merge 커밋을 구분해야 한다.</li>
<li>merge, rebase, cherry pick을 이해해야 한다.</li>
</ul>

<p><img src="/articles/2011/git-merge/thousand_sunny_ship.jpg" alt="힘내"></p>

<p>예를 들어 &lsquo;싸우전드 써니&rsquo; 호는 밀짚모자 해적단의 안전한 항해를 책임지고 있기 때문에 아주 잘 관리해야 한다.</p>

<p>보통 master, develop, pu(proposed updates), next 등으로 이름 짓는 브랜치가 긴 호흡 브랜치(long-runing branch)이다. 이 브랜치는 굉장히 오랫동안 유지하고 사실 거의 저장소에 내내 존재한다. 필요에 따라 삭제하기도 하지만 바로 다시 만들어야 하기 때문에 항상 필요하다. 각 브랜치는 브랜치 고유의 목적이 있다. 여기서 각 브랜치의 의미를 설명하지는 않는다.</p>

<p>이 글에서는 긴 호흡 브랜치로 ship 브랜치를 사용한다.</p>

<h2>Merge, Rebase, Cherry-pick</h2>

<p>먼저 merge, rebase, cherry-pick이 어떻게 다른지 알아보자. 각 명령어가 어떻게 다른지는 <a href="http://marklodato.github.com/visual-git-guide/index-ko.html">Visual git guide</a>에 잘 설명돼 있다.</p>

<p>merge, rebase, cherry-pick을 선택하기 전에 고려해야 하는 것 중의 하나로 해당 커밋을 공유하고 있는지가 중요하다. 이미 다른 사람과 공유한 커밋이라면 조심해야 한다. rebase, cherry-pick, squash는 내용이 같더라도 커밋 개체를 새로 만들어 버리기 때문에 조심해야 한다.</p>

<p>이미 공유하는 커밋이라면 기존의 커밋 개체를 바꾸면 안 되고 반드시 동료와 논의해야 한다. 그래야 동료가 혼란스러워하지 않는다.</p>

<h3>Merge</h3>

<p>긴 호흡 브랜치에 merge하는 것이 아니라면(토픽 브랜치에 merge하는 것이라면) 편한 방법으로 merge해도 된다. 토픽 브랜치는 보통 저장소에 올려 다른 사람과 공유하지 않기 때문에 커밋을 어떻게 작성하든 문제가 되지 않는다. 히스토리를 정돈하는 일은 저장소에 올려 다른 사람과 공유하기 전까지 미뤄도 괜찮다.</p>

<p>merge하기 전에 뭐가 다른지 확인해보는 것이 좋다. feature/sample이라는 토픽 브랜치를 ship 브랜치에 merge하는 경우에 다음과 같이 뭐가 다른지 살펴보자.</p>
<pre><code>git <span class="built_in">log</span> ship..feature/<span class="keyword">sample</span>
</code></pre>
<p>이 명령은 ship에는 없고 feature/sample에만 있는 커밋을 모두 보여준다. 그리고 나서 <code>git show</code> 명령으로 해당 커밋에서 도데체 무엇이 변경됐는지 확인할 수 있다.</p>

<h4>&lsquo;git merge &ndash;no-commit &ndash;squash&rsquo;</h4>

<p>이 명령은 토픽 브랜치를 긴 호흡 브랜치에 merge할 때 유용하다.</p>

<p>예를 들어 토픽 브랜치에서 작업한 것을 긴 호흡 브랜치에 merge할 때는 토픽 브랜치에 있는 커밋을 하나의 의미로 묶어서 merge하는 것이 좋다. 토픽 브랜치는 보통 하나의 이슈를 구현하기 때문에 하나의 의미가 있을 확률이 높다. 보통 개발하다 보면 동료와 의논하거나 백업하는 등 여러 가지 이유로 여러 번 커밋을 하는 경우가 많다. 그대로 긴 호흡 브랜치에 merge하지 말고 의미 단위로 합쳐서 merge한다.</p>

<p>ship 브랜치 히스토리가 다음과 같다고 하자:</p>
<pre><code><span class="comment">:::text</span>
<span class="comment">*</span> <span class="comment">23a973a</span> <span class="literal">-</span> <span class="comment">(ship)</span> <span class="comment">Add</span> <span class="comment">feature/sample</span>
<span class="comment">*</span> <span class="comment">1934594</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">ship</span>
</code></pre>
<p>이 상태에서 &lsquo;프랑키'는 feature/guns 브랜치를 만들어 대포를 두 번에 나눠서 달았다. 배를 고친 후 feature/guns 브랜치는 다음과 같다:</p>
<pre><code><span class="comment">:::text</span>
<span class="comment">*</span> <span class="comment">f296244</span> <span class="literal">-</span> <span class="comment">(feature/guns)</span> <span class="comment">Add</span> <span class="comment">gun2</span>
<span class="comment">*</span> <span class="comment">084ebfa</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">new</span> <span class="comment">A</span> <span class="comment">gun</span>
<span class="comment">*</span> <span class="comment">23a973a</span> <span class="literal">-</span> <span class="comment">(ship)</span> <span class="comment">Add</span> <span class="comment">feature/sample</span>
<span class="comment">*</span> <span class="comment">1934594</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">ship</span>
</code></pre>
<p>이것을 ship 브랜치에 merge하면 feature/guns는 ship을 base로 하고 있기 때문에 Fast-forward된다. ship 브랜치의 히스토리는 다음과 같아진다:</p>
<pre><code><span class="comment">*</span> <span class="comment">f296244</span> <span class="literal">-</span> <span class="comment">(ship</span>, <span class="comment">feature/guns)</span> <span class="comment">Add</span> <span class="comment">gun2</span>
<span class="comment">*</span> <span class="comment">084ebfa</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">new</span> <span class="comment">A</span> <span class="comment">gun</span>
<span class="comment">*</span> <span class="comment">23a973a</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">feature/sample</span>
<span class="comment">*</span> <span class="comment">1934594</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">ship</span>
</code></pre>
<p>사실 대포를 두 번에 나눠서 달았지만, ship 브랜치 히스토리에는 그냥 대포를 추가했다고 남기고 싶다. 대포를 나눠서 추가했든 한 번에 추가했든 그게 의미 있는 게 아니라 대포를 추가했다는 사실만 중요하기 때문에 하나로 합치는 것이 좋다.</p>

<p><code>git merge --no-commit --squash</code> 명령으로 두 커밋을 합쳐서 merge하면 다음과 같아진다:</p>
<pre><code><span class="comment">:::text</span>
<span class="comment">*</span> <span class="comment">99f108e</span> <span class="literal">-</span> <span class="comment">(ship)</span> <span class="comment">Add</span> <span class="comment">new</span> <span class="comment">guns</span>
<span class="comment">*</span> <span class="comment">23a973a</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">feature/sample</span>
<span class="comment">*</span> <span class="comment">1934594</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">ship</span>
</code></pre>
<p><code>--no-commit</code> 옵션을 주면 말 그대로 merge한 후 commit하지 않는다. <code>--no--commit</code> 옵션이 없더라도 커밋 여러 개를 합친 것이기(squash) 때문에 merge만하고 자동으로 커밋해주지 않는다. 수동으로 커밋 메시지를 수정하고 커밋한다.</p>

<h3>Rebase</h3>

<p>'프랑키'가 대포를 추가하는 사이에 '나미'는 'feature/tangerine&rsquo; 브랜치를 만들고 귤 나무를 하나 심었다:</p>
<pre><code><span class="comment">:::text</span>
<span class="comment">*</span> <span class="comment">945381e</span> <span class="literal">-</span> <span class="comment">(feature/tangerine)</span> <span class="comment">Plant</span> <span class="comment">new</span> <span class="comment">tangerine</span>
<span class="comment">*</span> <span class="comment">23a973a</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">feature/sample</span>
<span class="comment">*</span> <span class="comment">1934594</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">ship</span>
</code></pre>
<p>&lsquo;나미'는 자신의 결과물을 push하기 위해서 먼저 pull한다. 그럼 ‘나미’의 ship 브랜치는 다음과 같다:</p>
<pre><code><span class="comment">:::text</span>
<span class="comment">*</span> <span class="comment">99f108e</span> <span class="literal">-</span> <span class="comment">(ship)</span> <span class="comment">Add</span> <span class="comment">new</span> <span class="comment">guns</span>
<span class="comment">*</span> <span class="comment">23a973a</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">feature/sample</span>
<span class="comment">*</span> <span class="comment">1934594</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">ship</span>
</code></pre>
<p>merge하기 전에 여기서도 두 브랜치에 어떤 차이가 있는 지 확인한다. 이때는 <code>git log --left-right ship...feature/tangerine</code> 명령으로 두 브랜치 사이에 뭐가 다른지 확인한다. <code>...</code>은 서로 다른 커밋을 모두 보여준다.</p>
<pre><code>:::text
&gt; <span class="number">945381</span>e - (feature/tangerine) Plant <span class="keyword">new</span> tangerine
&lt; <span class="number">99f</span>108e - (ship) Add <span class="keyword">new</span> guns
</code></pre>
<p><code>&gt;</code>는 파라미터로 넘긴 오른쪽 브랜치에만 있는 커밋이고 <code>&lt;</code>는 왼쪽 브랜치에만 있는 커밋이다. 여기서 feature/tangerine를 merge하면 ship 브랜치는 다음과 같아진다:</p>
<pre><code><span class="comment">:::text</span>
<span class="comment">*</span>   <span class="comment">2cc0cb8</span> <span class="literal">-</span> <span class="comment">(dev)</span> <span class="comment">Merge</span> <span class="comment">branch</span> <span class="comment">'feature/tangerine'</span> <span class="comment">into</span> <span class="comment">dev</span>
<span class="comment">|\</span>
<span class="comment">|</span> <span class="comment">*</span> <span class="comment">945381e</span> <span class="literal">-</span> <span class="comment">(feature/tangerine)</span> <span class="comment">Plant</span> <span class="comment">new</span> <span class="comment">tangerine</span>
<span class="comment">*</span> <span class="comment">|</span> <span class="comment">99f108e</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">new</span> <span class="comment">guns</span>
<span class="comment">|/</span>
<span class="comment">*</span> <span class="comment">23a973a</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">feature/sample</span>
<span class="comment">*</span> <span class="comment">1934594</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">ship</span>
</code></pre>
<p>ship 브랜치에 merge 커밋이 들어갔기 때문에 히스토리가 선형적이지 않다. 곧 사라질 브랜치인 'feature/tangerine&rsquo; 브랜치의 잔재가 커밋 히스토리에 남는다. 이럴 때는 rebase가 필요하다. 다음과 같이 feature/tangerine 브랜치를 checkout하고 rebase한다:</p>
<pre><code>$ git checkout feature/tangerine
$ git rebase ship
First, rewinding head <span class="keyword">to</span> replay your work <span class="function_start"><span class="keyword">on</span> <span class="title">top</span></span> <span class="keyword">of</span> <span class="keyword">it</span>...
Applying: Plant new tangerine
</code></pre>
<p>그럼 feature/tangerine의 히스토리는 다음과 같아진다:</p>
<pre><code><span class="comment">:::text</span>
<span class="comment">*</span> <span class="comment">0c8c128</span> <span class="literal">-</span> <span class="comment">(feature/tangerine)</span> <span class="comment">Plant</span> <span class="comment">new</span> <span class="comment">tangerine</span>
<span class="comment">*</span> <span class="comment">99f108e</span> <span class="literal">-</span> <span class="comment">(ship)</span> <span class="comment">Add</span> <span class="comment">new</span> <span class="comment">guns</span>
<span class="comment">*</span> <span class="comment">23a973a</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">feature/sample</span>
<span class="comment">*</span> <span class="comment">1934594</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">ship</span>
</code></pre>
<p>feature/tangerine의 히스토리를 잘 보자. feature/tangerine 브랜치에서 추가한 커밋의 SHA 값이 &lsquo;945381e'에서 '0c8c128'로 바뀌었다. rebase하면 ship 브랜치가 가리키는 커밋을 base로 해서 해당 커밋 개체를 다시 만든다. 그래서 저장소에 이미 push한 커밋에 대해서 rebase하면 다른 동료가 혼란스러워하고 히스토리를 다시 정리하기 위해 추가작업이 필요해진다</p>

<p>그리고 나서 ship 브랜치에 feature/tangerine을 merge한다. 이때 feature/tangerine 브랜치는 ship 브랜치를 base로 하기 때문에 Fast-forward된다. merge하면 ship 브랜치의 히스토리는 다음과 같아진다:</p>
<pre><code><span class="comment">:::text</span>
<span class="comment">*</span> <span class="comment">0c8c128</span> <span class="literal">-</span> <span class="comment">(ship</span>, <span class="comment">feature/tangerine)</span> <span class="comment">Plant</span> <span class="comment">new</span> <span class="comment">tangerine</span>
<span class="comment">*</span> <span class="comment">99f108e</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">new</span> <span class="comment">guns</span>
<span class="comment">*</span> <span class="comment">23a973a</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">feature/sample</span>
<span class="comment">*</span> <span class="comment">1934594</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">ship</span>
</code></pre>
<h3>Cherry-pick</h3>

<p>'루피'는 고기와 과일을 가지고 돌아왔다. '루피'의 브랜치, feature/food는 다음과 같다:</p>
<pre><code><span class="comment">:::text</span>
<span class="comment">*</span> <span class="comment">df19672</span> <span class="literal">-</span> <span class="comment">(feature/food)</span> <span class="comment">Add</span> <span class="comment">fruits</span>
<span class="comment">*</span> <span class="comment">663ced1</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">meats</span>
<span class="comment">*</span> <span class="comment">0c8c128</span> <span class="literal">-</span> <span class="comment">(ship)</span> <span class="comment">Plant</span> <span class="comment">new</span> <span class="comment">tangerine</span>
<span class="comment">*</span> <span class="comment">99f108e</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">new</span> <span class="comment">guns</span>
<span class="comment">*</span> <span class="comment">23a973a</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">feature/sample</span>
<span class="comment">*</span> <span class="comment">1934594</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">ship</span>
</code></pre>
<p>그런데 배에 이미 과일이 많아서 고기만 배에 넣기로 했다. 두 커밋 'df19672&rsquo;, &lsquo;663ced1&rsquo; 중에서 &lsquo;663ced1&rsquo; 골라서 merge 시킬 수 있을까? 이럴 때 cherry-pick을 사용한다. cherry-pick은 기여자가 보내온 커밋 중에서 하나만 rebase하는 것이다. 커밋 하나만 rebase하는 것이기 때문에 커밋 개체도 새로 만들어진다.</p>

<p>ship 브랜치로 이동해서 <code>git cherry-pick 663ced1</code> 명령을 실행하면 ship 브랜치 히스토리는 다음과 같아진다:</p>
<pre><code><span class="comment">:::text</span>
<span class="comment">*</span> <span class="comment">271fa93</span> <span class="literal">-</span> <span class="comment">(ship</span>, <span class="comment">feature/food)</span> <span class="comment">Add</span> <span class="comment">meats</span>
<span class="comment">*</span> <span class="comment">0c8c128</span> <span class="literal">-</span> <span class="comment">Plant</span> <span class="comment">new</span> <span class="comment">tangerine</span>
<span class="comment">*</span> <span class="comment">99f108e</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">new</span> <span class="comment">guns</span>
<span class="comment">*</span> <span class="comment">23a973a</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">feature/sample</span>
<span class="comment">*</span> <span class="comment">1934594</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">ship</span>
</code></pre>
<h2>Fast-forward Merge와 Merge 커밋</h2>

<p>merge 커밋을 해야 하는 이유는 대개 이슈사항을 커밋 하나로 정리할 수 없기 때문이다. 이슈를 하나로 정리해서 히스토리를 선형적으로 관리하는 것도 좋은 방법이지만 커밋 하나로 정리할 수 없는 이슈를 하나로 정리해 버리면 나중에 추적하기도 관리하기도 어려워진다.</p>

<h3>Fast-forward Merge</h3>

<p>이슈를(토픽 브랜치를) 하나의 커밋으로 정리할 수 있다면 fast-forward merge가 낫다. 브랜치에 커밋이 하나면 그 커밋 메시지를 적절히 수정해서 merge하고 아니면 하나로 합쳐서 merge한다. 커밋이 하나인 브랜치를 merge할 때 merge 커밋을 히스토리에 남기면 브랜치 이름을 기록해 두는 것 이외에 아무런 이득이 없다.</p>

<p>fast-forward merge하는 방법을 살펴보자. &lsquo;프랑키'는 feature/fix-ship 브랜치를 만들어 뱃머리와 닻을 수리했다:</p>
<pre><code><span class="comment">*</span> <span class="comment">52f084e</span> <span class="literal">-</span> <span class="comment">(HEAD</span>, <span class="comment">feature/fix</span>-<span class="comment">ship)</span> <span class="comment">Fix</span> <span class="comment">anchor</span>
<span class="comment">*</span> <span class="comment">eb1db0d</span> <span class="literal">-</span> <span class="comment">Fix</span> <span class="comment">sunny</span> <span class="comment">bow</span>
<span class="comment">*</span> <span class="comment">271fa93</span> <span class="literal">-</span> <span class="comment">(ship)</span> <span class="comment">Add</span> <span class="comment">meats</span>
<span class="comment">*</span> <span class="comment">0c8c128</span> <span class="literal">-</span> <span class="comment">Plant</span> <span class="comment">new</span> <span class="comment">tangerine</span>
<span class="comment">*</span> <span class="comment">99f108e</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">new</span> <span class="comment">guns</span>
<span class="comment">*</span> <span class="comment">23a973a</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">feature/sample</span>
<span class="comment">*</span> <span class="comment">1934594</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">ship</span>
</code></pre>
<p>이 브랜치를 ship 브랜치에 merge한다. 먼저, <code>...</code>으로 fast-forward merge될 수 있는지 확인한다.</p>
<pre><code><span class="comment">$</span> <span class="comment">git</span> <span class="comment">log</span> <span class="literal">-</span><span class="literal">-</span><span class="comment">left</span>-<span class="comment">right</span> <span class="comment">ship</span>.<span class="string">.</span><span class="string">.</span><span class="comment">feature/fix</span>-<span class="comment">ship</span>
&gt; <span class="comment">52f084e</span> <span class="literal">-</span> <span class="comment">(feature/fix</span>-<span class="comment">ship)</span> <span class="comment">Fix</span> <span class="comment">anchor</span>
&gt; <span class="comment">eb1db0d</span> <span class="literal">-</span> <span class="comment">Fix</span> <span class="comment">sunny</span> <span class="comment">bow</span>
</code></pre>
<p>feature/fix-ship 브랜치는 ship 브랜치를 base로 하기 때문에 fast-forward merge될 수 있다. <code>merge-base</code> 명령으로도 확인할 수 있다. 이 명령은 두 브랜치가 공통으로 하는 공통 커밋을 알려준다:</p>
<pre><code>$ git merge-<span class="keyword">base</span> ship feature/fix-ship
<span class="number">271</span>fa933f42c7d6b0fa1e967c7d73801e83936b3
</code></pre>
<p>ship은 '271fa93'를 가리키고 있고 feature/fix-ship은 그 커밋을 base로 하고 있다.</p>

<p><code>--no-ff</code> 옵션을 사용하지 않고 merge하면 fast-forward merge된다.</p>
<pre><code>$ git checkout ship
$ git merge feature/fix-ship 
Updating 271fa93..52f084e
Fast-forward
 0 files changed, 0 insertions(+), 0 deletions(-)
 <span class="operator"><span class="keyword">create</span> mode <span class="number">100644</span> anchor
 <span class="keyword">create</span> mode <span class="number">100644</span> sunny
</code></pre>
<h3>Merge 커밋</h3>

<p>merge 커밋은 단순하게 말해서 커밋의 집합이라고 생각할 수 있다. merge 커밋을 만들어야 하는 때는 여러 커밋을 묶어서 관리하고자 할 때이다.</p>

<p>merge 커밋을 하면 여러 개의 커밋을 하나로 관리하고 어떤 브랜치에서 merge한 것인지 기록을 남길 수 있다. merge 커밋을 해보자.</p>

<p>위에서 merge 했던 것을 다시 원상태로 돌린다(revert):</p>
<pre><code>$ git re<span class="operator"><span class="keyword">set</span> --hard HEAD~<span class="number">2</span>
HEAD <span class="keyword">is</span> now <span class="keyword">at</span> <span class="number">271</span>fa93 <span class="keyword">Add</span> meats
</code></pre>
<p>커밋이 두 개라서 feature 하나를 원래대로 복구 할 때 커밋 두 개를 모두 reset해야 한다.</p>

<p>이제 <code>--no-ff</code>을 주고 merge 커밋을 만든다.</p>
<pre><code>$ git checkout ship
$ git merge <span class="comment">--no-ff feature/fix-ship</span>
Merge made by recursive.
 0 files changed, 0 insertions(+), 0 deletions(-)
 <span class="operator"><span class="keyword">create</span> mode <span class="number">100644</span> anchor
 <span class="keyword">create</span> mode <span class="number">100644</span> sunny
</code></pre>
<p>이제 ship 브랜치의 히스토리를 살펴보자:</p>
<pre><code><span class="comment">*</span>   <span class="comment">65f14bd</span> <span class="literal">-</span> <span class="comment">(HEAD</span>, <span class="comment">ship)</span> <span class="comment">Merge</span> <span class="comment">branch</span> <span class="comment">'feature/fix</span>-<span class="comment">ship'</span> <span class="comment">into</span> <span class="comment">ship</span>
<span class="comment">|\</span>  
<span class="comment">|</span> <span class="comment">*</span> <span class="comment">52f084e</span> <span class="literal">-</span> <span class="comment">(feature/fix</span>-<span class="comment">ship)</span> <span class="comment">Fix</span> <span class="comment">anchor</span>
<span class="comment">|</span> <span class="comment">*</span> <span class="comment">eb1db0d</span> <span class="literal">-</span> <span class="comment">Fix</span> <span class="comment">sunny</span> <span class="comment">bow</span>
<span class="comment">|/</span> 
<span class="comment">*</span> <span class="comment">271fa93</span> <span class="literal">-</span> <span class="comment">(ship)</span> <span class="comment">Add</span> <span class="comment">meats</span>
<span class="comment">*</span> <span class="comment">0c8c128</span> <span class="literal">-</span> <span class="comment">Plant</span> <span class="comment">new</span> <span class="comment">tangerine</span>
<span class="comment">*</span> <span class="comment">99f108e</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">new</span> <span class="comment">guns</span>
<span class="comment">*</span> <span class="comment">23a973a</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">feature/sample</span>
<span class="comment">*</span> <span class="comment">1934594</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">ship</span>
</code></pre>
<p>어떤 feature를 merge했고 그 feature에 해당하는 커밋이 무엇인지 히스토리에 남는다. 만약 이 merge를 취소하고 싶을 때는 다음과 같이 실행하면 된다.</p>
<pre><code>$ git re<span class="operator"><span class="keyword">set</span> --hard HEAD~<span class="number">1</span>
HEAD <span class="keyword">is</span> now <span class="keyword">at</span> <span class="number">271</span>fa93 <span class="keyword">Add</span> meats
</code></pre>
<p>merge 커밋이 있기 때문에 'HEAD~1&rsquo; 만으로도 feature/fix-ship에 해당하는 커밋이 모두 reset된다:</p>
<pre><code><span class="comment">*</span> <span class="comment">271fa93</span> <span class="literal">-</span> <span class="comment">(HEAD</span>, <span class="comment">ship)</span> <span class="comment">Add</span> <span class="comment">meats</span>
<span class="comment">*</span> <span class="comment">0c8c128</span> <span class="literal">-</span> <span class="comment">Plant</span> <span class="comment">new</span> <span class="comment">tangerine</span>
<span class="comment">*</span> <span class="comment">99f108e</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">new</span> <span class="comment">guns</span>
<span class="comment">*</span> <span class="comment">23a973a</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">feature/sample</span>
<span class="comment">*</span> <span class="comment">1934594</span> <span class="literal">-</span> <span class="comment">Add</span> <span class="comment">ship</span>
</code></pre>
<h2>결론</h2>

<p>Vincent Driessen는 <a href="http://dogfeet.github.com/articles/2011/a-successful-git-branching-model.html">A successful Git branching model</a>에서 &ndash;no-ff를 기본 옵션으로 해야 한다고 했지만, 꼭 그렇지 않다. 히스토리를 어떻게 관리할지에 따라 선택해야 하고 fast-forward merge해야 하는 경우도 매우 많다.</p>

<p>실제로 Driessen이 저 글의 내용을 구현한 <a href="https://github.com/nvie/gitflow">git-flow</a>에서도 feature 브랜치에 commit이 하나만 있으면 develop 브랜치에 fast-forward로 merge한다.</p>
</div></div></div></article></section><section id="related"><div class="row"><div class="offset2 span10"><h3>Related Posts</h3><ul><li><span>Mar 30 2012</span>&raquo;<a href="/articles/2012/first-speach.html">KTH 발표</a></li><li><span>Jan 14 2012</span>&raquo;<a href="/articles/2012/git-branch-a-v.html">Git:branch-a-v</a></li><li><span>Dec 29 2012</span>&raquo;<a href="/articles/2012/git-github-secrets.html">Git: GitHub secrets</a></li><li><span>Feb 10 2012</span>&raquo;<a href="/articles/2012/git-global-ignore.html">Git: Global Ignore</a></li><li><span>Aug 12 2012</span>&raquo;<a href="/articles/2012/git-merge-rebase.html">Git: Rebase는 언제 어떻게 해야 할까?</a></li><li><span>Dec 19 2012</span>&raquo;<a href="/articles/2012/git-secrets.html">Git: git secrets</a></li><li><span>Jan 21 2012</span>&raquo;<a href="/articles/2012/git-todo.html">Git:Todo Plugin</a></li><li><span>Mar 03 2012</span>&raquo;<a href="/articles/2012/git-tracking-vs-remote-tracking.html">Git: Remote Tracking Branch vs Tracking Branch</a></li><li><span>Feb 02 2012</span>&raquo;<a href="/articles/2012/git-translate-flow.html">Git:번역 Workflow</a></li><li><span>Apr 01 2012</span>&raquo;<a href="/articles/2012/how-to-github.html">GitHub로 남의 프로젝트에 감놓고 배놓기</a></li></ul></div></div></section><section id="comments"><div class="row"><div class="offset2 span10"><h3>Feedback</h3><div id="disqus_thread" class="well"></div>
<script type="text/javascript">
    var disqus_shortname = 'dogfeet-github';
    var disqus_identifier = '/articles/2011/git-merge.html';
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><div class="well">
  <div class="fb-like" data-href="http://dogfeet.github.com/articles/2011/git-merge.html" data-send="true" data-width="450" data-show-faces="true"></div>
  <div class="fb-comments" data-href="http://dogfeet.github.com/articles/2011/git-merge.html" data-num-posts="1"></div>
</div></div></div></section></div><footer class="footer"><p>Copyright &copy; 2008-2012 Dogfeet from coding to pixels, powered by <a href="https://github.com/balupton/docpad">Docpad</a></p></footer></div><!--DISQUS--><script>var disqus_shortname = 'dogfeet-github';
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());</script><!--GA--><script>if( 'http://dogfeet.github.com' === 'http://' + window.location.hostname ) {
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-27493298-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
}</script></body></html>